@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
<form action="/Home/DBdata" method="get" style="text-align:center">
    <input style="width:50%" id="connection" type="text" name="DBConnection" />
    @*<input type="submit" value="查詢" />*@
    <input type="button" value="查詢" onclick="getdb()" />
    <input type="button" value="Dapper" onclick="getdbByDapper()" />
</form>


<div id="database"></div>


<script>

    //以連接字串呼叫DBdata後傳回該DB的內容插入頁面
    function getdb() {
        $.ajax({
            url: `/Home/DBdata/?DBConnection=${$("#connection").val()}`,
            success: function (data) {
                if (data === "error") 
                    return window.alert("連結錯誤");
                $("#database").html(data);
            }
        })
    }

    function getdbByDapper() {
        $.ajax({
            url: `/Dapper/DBdata/?DBConnection=${$("#connection").val()}`,
            success: function (data) {
                if (data === "error")
                    return window.alert("連結錯誤");
                $("#database").html(data);
            }
        })
    }

    //特殊字元轉碼，避免input特殊字元導致錯誤
    function escapeHtml(unsafe) {
        return unsafe
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }
</script>